---
const navLinks = [
  { href: '/about', label: 'About' },
  { href: '/services', label: 'Services' },
  { href: '/faq', label: 'FAQ' },
  { href: '/contact', label: 'Contact' },
];
---

<header id="header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-500">
  <!-- Decorative hairline to keep the header feeling intentional over photos -->
  <div class="gold-accent-line opacity-60"></div>
  <nav class="max-w-7xl mx-auto px-6 lg:px-12 py-6 flex items-center justify-between">
    <!-- Logo -->
    <a href="/" class="group relative z-10" data-magnetic="0.2">
      <img
        src="/images/logo-header.png"
        alt="Virginia Page & Co. Hair Studio"
        class="h-16 md:h-24 lg:h-32 w-auto"
      />
    </a>

    <!-- Desktop Nav -->
    <div class="hidden md:flex items-center gap-4">
      <div class="nav-capsule flex items-center gap-10 px-8 py-3">
        {navLinks.map(link => (
          <a
            href={link.href}
            class="text-sm tracking-widest uppercase link-underline opacity-80 hover:opacity-100 hover:text-[--color-gold] transition-all duration-300"
          >
            {link.label}
          </a>
        ))}
      </div>
      <a href="/book" class="btn btn-primary btn-header-cta hover:shadow-[0_0_25px_rgba(196,169,98,0.35)] transition-shadow duration-300">
        Book Now
      </a>
    </div>

    <!-- Mobile Menu Button (44x44 minimum touch target for accessibility) -->
    <button
      id="mobile-menu-btn"
      class="md:hidden relative z-10 w-11 h-11 flex flex-col items-center justify-center gap-1.5"
      aria-label="Toggle menu"
      aria-expanded="false"
      aria-controls="mobile-menu"
    >
      <span class="menu-line w-6 h-px bg-current transition-all duration-300"></span>
      <span class="menu-line w-6 h-px bg-current transition-all duration-300"></span>
    </button>
  </nav>
</header>

<!-- Mobile Menu - OUTSIDE header for proper stacking context -->
<div id="mobile-menu" class="md:hidden">
  <nav class="text-center">
    {navLinks.map(link => (
      <a
        href={link.href}
        class="block text-4xl mb-6 tracking-wide hover:text-[--color-gold] transition-colors"
        style="font-family: var(--font-display);"
      >
        {link.label}
      </a>
    ))}
    <a href="/book" class="btn btn-primary mt-8">
      Book Now
    </a>
  </nav>
</div>

<!-- Spacer for fixed header -->
<div class="h-24"></div>

<style>
  /* Make the header readable on the hero image without feeling heavy. */
  #header {
    background: linear-gradient(
      to bottom,
      rgba(250, 247, 242, 0.78),
      rgba(250, 247, 242, 0.55)
    );
    backdrop-filter: blur(12px) saturate(1.1);
    box-shadow: 0 1px 0 rgba(45, 42, 38, 0.06);
  }

  #header.scrolled {
    background: rgba(250, 247, 242, 0.96);
    backdrop-filter: blur(12px) saturate(1.1);
    box-shadow: 0 1px 0 rgba(45, 42, 38, 0.05);
  }

  #header.scrolled nav {
    padding-top: 1rem;
    padding-bottom: 1rem;
  }

  /* Capsule nav is a subtle "signature" that doesn't read as Squarespace default. */
  .nav-capsule {
    background: rgba(250, 247, 242, 0.65);
    border: 1px solid rgba(45, 42, 38, 0.08);
    border-radius: 999px;
    box-shadow: 0 10px 30px -28px rgba(45, 42, 38, 0.35);
    backdrop-filter: blur(10px);
  }

  /* Slightly tighter header CTA so it doesn't overpower the nav capsule. */
  .btn-header-cta {
    padding: 0.9rem 2.1rem;
  }
  
  #mobile-menu {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #FAF7F2;
    z-index: 9990;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
    transition: opacity 0.3s ease, visibility 0.3s ease;
  }

  #mobile-menu.active {
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
  }
  
  #mobile-menu-btn.active .menu-line:first-child {
    transform: rotate(45deg) translate(2px, 2px);
  }
  
  #mobile-menu-btn.active .menu-line:last-child {
    transform: rotate(-45deg) translate(2px, -2px);
  }
</style>

<script>
  // Scroll effect
  const header = document.getElementById('header');
  window.addEventListener('scroll', () => {
    if (window.scrollY > 50) {
      header?.classList.add('scrolled');
    } else {
      header?.classList.remove('scrolled');
    }
  });
  
  // Mobile menu with accessibility support
  const menuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');

  menuBtn?.addEventListener('click', () => {
    const isActive = menuBtn.classList.toggle('active');
    mobileMenu?.classList.toggle('active');
    document.body.style.overflow = isActive ? 'hidden' : '';
    // Update ARIA state for screen readers
    menuBtn.setAttribute('aria-expanded', isActive ? 'true' : 'false');
  });

  // Close menu on escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && mobileMenu?.classList.contains('active')) {
      menuBtn?.classList.remove('active');
      mobileMenu?.classList.remove('active');
      document.body.style.overflow = '';
      menuBtn?.setAttribute('aria-expanded', 'false');
      menuBtn?.focus();
    }
  });

  // Close menu when clicking a link
  mobileMenu?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      menuBtn?.classList.remove('active');
      mobileMenu?.classList.remove('active');
      document.body.style.overflow = '';
      menuBtn?.setAttribute('aria-expanded', 'false');
    });
  });
</script>
